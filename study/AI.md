
# åŠ ç­è®¡åˆ’é¡¾é—® `advisor.py` çŸ¥è¯†åº“ ğŸ—‚ï¸

> ä¸€é”®ç”Ÿæˆ **æœ¬æœˆåŠ ç­è®¡åˆ’**ï¼ˆé˜¶æ®µ + å‘¨å…­ + å·¥ä½œæ—¥ï¼‰ï¼ŒAI å¤±è´¥è‡ªåŠ¨å…œåº•ï¼Œå…¨éƒ¨å‚æ•°å¯é…ç½®ã€‚

---
## ğŸ“¦ æ–‡ä»¶ç»“æ„
project/

â”œâ”€ config.json# AI & ä¸šåŠ¡å‚æ•°

â”œâ”€ overtime_report.xlsx  # ç”± report_overtime.py ç”Ÿæˆ

â”œâ”€ advisor.py            # â† æœ¬æ–‡ä»¶

â””â”€ main.py               # å”¯ä¸€å…¥å£
å¤åˆ¶

---

## ğŸ§  åŠŸèƒ½ä¸€è§ˆ

| åŠŸèƒ½ | è¯´æ˜ |
|---|---|
| **é˜¶æ®µåˆ¤å®š** | æœˆåˆ / æœˆä¸­ / æœˆæœ« |
| **å‘¨å…­ä¿åº•** | æ¯æœˆå‰©ä½™å‘¨å…­ â‰¥ 6 hï¼Œæ— ä¸Šé™ |
| **å·¥ä½œæ—¥å…œåº•** | 18:00 èµ·ç®—ï¼Œç¼ºå£äºŒæ¬¡åˆ†æ‘Š |
| **AI/å…œåº•åˆ‡æ¢** | å¤±è´¥åŸå› è‡ªåŠ¨å›æ˜¾ |
| **é…ç½®çƒ­åŠ è½½** | max_tokens/temperature/timeout å†™åœ¨ `config.json` |

---

## ğŸ”§ é…ç½®ç¤ºä¾‹ (`config.json`)

```json
{
  "office": {
    "work_start": "09:00",
    "work_end": "18:00",
    "lunch_break_minutes": 60,
    "required_overtime_hours_monthly": 20
  },
  "ai": {
    "api_base": "https://api.siliconflow.cn/v1",
    "model": "deepseek-ai/DeepSeek-V3",
    "api_key": "sk-xxx",
    "max_tokens": 400,
    "temperature": 0.6,
    "timeout": 30
  }
}
```
ğŸš€ å¿«é€Ÿä½¿ç”¨
```
from advisor import make_plan
summary_df, advice = make_plan(df, cfg)
summary_df.to_excel("åŠ ç­è®¡åˆ’.xlsx", index=False)
with open("åŠ ç­è®¡åˆ’.txt", "w", encoding="utf-8") as f:
    f.write(advice)
```
### ğŸ“Š è¾“å‡ºå­—æ®µ

| å­—æ®µ           | ç±»å‹  | è¯´æ˜                           |
|----------------|-------|--------------------------------|
| å½“å‰æ—¥æœŸ       | date  | è¿è¡Œå½“å¤©                       |
| é˜¶æ®µ           | str   | æœˆåˆ / æœˆä¸­ / æœˆæœ«             |
| å‰©ä½™éœ€åŠ ç­     | float | è¿˜éœ€å¤šå°‘å°æ—¶                   |
| å‰©ä½™å·¥ä½œæ—¥     | int   | æœ¬æœˆå‰©ä½™å·¥ä½œæ—¥æ•°               |
| æ¯æ—¥ç›®æ ‡(h)    | float | å·¥ä½œæ—¥æ¯æ—¥éœ€åŠ ç­å°æ—¶           |
| å‘¨å…­å‰©ä½™       | int   | æœ¬æœˆå‰©ä½™å‘¨å…­æ•°ï¼ˆâ‰¥6h/æ¬¡ï¼‰       |
| æ¥æº           | str   | AI / å…œåº•                      |

---

### ğŸ“ˆ é˜¶æ®µ & å‘¨å…­æ¨è

| é˜¶æ®µ | å‘¨å…­ç­–ç•¥                     | å·¥ä½œæ—¥ç­–ç•¥               |
|------|------------------------------|--------------------------|
| æœˆåˆ | ä¼˜å…ˆæ’æ»¡å‘¨å…­ï¼Œå‡è½»å·¥ä½œæ—¥å‹åŠ› | å¯å°‘é‡æˆ–æ— éœ€å·¥ä½œæ—¥åŠ ç­   |
| æœˆä¸­ | å‘¨å…­ + å·¥ä½œæ—¥å¹¶è¡Œ            | æ¯æ—¥ 18:00 èµ·è¡¥è¶³å‰©ä½™   |
| æœˆæœ« | å‘¨å…­å¤šæ’ï¼ˆâ‰¥6h/æ¬¡ï¼‰           | å·¥ä½œæ—¥å†²åˆºæ”¶å°¾           |

ğŸ› ï¸ æ ¸å¿ƒç®—æ³•
```
# å‘¨å…­å‰©ä½™æ•°ï¼ˆæ— è§†æ˜¯å¦æ³•å®šï¼‰
saturdays_left = len(pd.date_range(today,
                                   today.replace(day=28)+pd.Timedelta(days=4),
                                   freq='W-SAT'))

# å‘¨å…­æ€»å¯ç”¨ â‰¥ 6 h Ã— saturdays_left
sat_total = saturdays_left * 6
remain_after_sat = max(need - sat_total, 0)
```

ğŸš© AI å¤±è´¥å›æ˜¾
```
å¤åˆ¶
ã€AI è°ƒç”¨å¤±è´¥ã€‘HTTPSConnectionPool(host='api.siliconflow.cn', port=443): Read timed out.
```
